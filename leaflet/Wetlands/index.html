<!DOCTYPE html>
<html lang='en'>
  <head>
    <title>Wetlands</title>

    <meta charset='utf-8'>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Styles -->
    <!-- Bootstrap cssS -->
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/bootstrap-reboot.min.css">
    <link rel="stylesheet" href="css/custom.css"/>
    <link rel="stylesheet" href="lib/marker-cluster/MarkerCluster.css"/>
    <link rel="stylesheet" href="lib/marker-cluster/MarkerCluster.Default.css"/>
    <link rel="stylesheet" href="css/leaflet.css"/>

    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="lib/jquery-3.3.1.min.js"></script>
    <script src="lib/popper.min.js"></script>
    <script src="lib/bootstrap.min.js"></script>
    <script src="https://use.fontawesome.com/52483a0e22.js"></script>
    <script src="lib/ejs.min.js"></script>
    <script src="lib/jquery.address.js"></script>
    <script src="lib/jquery.csv.min.js"></script>
    <script src="lib/moment.js"></script>
    <script src="lib/geojson.min.js"></script>
    <script src="js/csv-to-geojson.js"></script>

  
    <script src="lib/leaflet/leaflet.js"></script>
    <script src='lib/turf.min.js'></script>
    <script src="lib/leaflet-color-markers.js" ></script>
    <script src="lib/marker-cluster/leaflet.markercluster.js" ></script>
    

  </head>
  <body>

    <nav class="navbar navbar-expand-md navbar-light mb-2">
      <a class="navbar-brand" href="/">
        Wetlands Map
      </a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExampleDefault" aria-controls="navbarsExampleDefault" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse mr-auto" id="navbarsExampleDefault">
        <ul class="navbar-nav ml-auto">
          <li class='nav-item'>
            <a class="nav-link active" href="/"><i class="fa fa-map-marker" aria-hidden="true"></i> Map</a>
          </li>
        </ul>
      </div>
    </nav>

    <main role="main" class="container-fluid">

      <div class='row'>
        <div class="col-md-3">
          <p>We can add some explanations here. We can add some explanations here. We can add some explanations here. We can add some explanations here. We can add some explanations here. We can add some explanations here.<br /><a href='#'>Read more &raquo;</a></p>

          <i id="loading" class="fa fa-3x fa-spinner fa-spin" style="display: none;"></i>
          <div class="card bg-light" style="display: none;">
            <div class="card-body">
              <div class='row'>
                <div class="col-md-8">
                  <div class="form-group">
                      Near an address
                      <input class='form-control' id='search-address' placeholder='Enter an address' type='text'>
                  </div>
                </div>

                <div class="col-md-4">
                  <div class='form-group'>
                      Within
                      <select id='search-radius' class='form-control'>
                        <option value='1610'>1 mile</option>
                        <option value='3220'>2 miles</option>
                        <option value='8050'>5 miles</option>
                      </select>
                  </div>
                </div>
              </div>

              <div class='row'>
                <div class="col-md-12">
                  <div class="form-group">
                      Search by name
                      <input class='form-control' id='search-name' placeholder='Enter a business or organization name' type='text'>
                  </div>
                </div>
              </div>

              <button class='btn btn-primary' id="btnSearch"><i class='fa fa-search'></i> Search</button>
              <a href="/" class='btn btn-secondary' id="btnReset" title="Reset"><i class="fa fa-repeat" aria-hidden="true"></i> Reset</a>
              <button class='btn btn-dark' id='btnViewMode' title='Change view'><i class='fa fa-list'></i> List view</button>

              </div>
            </div>
          </div>

          <div class='col-md-9'>
            <div id='mapCanvas' style="display: block; height: 1000px;"></div>
          </div>
        </div>

        <div class="modal fade" id="modal-pop" tabindex="-1" role="dialog">
          <div class="modal-dialog modal-lg">
            <div class="modal-content">
              <div class="modal-body">
                <div class="container-fluid bd-example-row">
                  <div class="row">
                    <div class="col-md-12">
                      <button type="button" class="close close-btn" data-dismiss="modal" aria-label="Close"><span aria-hidden="true"><i class="fa fa-times-circle" aria-hidden="true"></i></span></button>
                      <div id="modal-main"></div>
                    </div>
                  </div>
                </div>
              </div>
            </div><!-- /.modal-content -->
          </div><!-- /.modal-dialog -->
        </div><!-- /.modal -->

        <script type="text/javascript">

        $(window).resize(function () {
          var h = $(window).height(),
            offsetTop = 70; // Calculate the top offset

          $('#mapCanvas').css('height', (h - offsetTop));
        }).resize();

        var map = L.map('mapCanvas', {
            renderer: L.canvas()
        }).setView([38.32559334, 35.26421442], 2);


        var osmTileLayer = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);

        $("#loading").show();
        $.get("https://us-central1-upwork-leaflet.cloudfunctions.net/ramsarPoints", function (data) {
            
            var markers = L.markerClusterGroup();
            markers.addLayer(L.geoJson(data));
            map.addLayer(markers);
            $("#loading").hide();
        });
        
        </script>

    </main>
  </body>
</html>